<!DOCTYPE html>
<html lang="cs">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Odstranƒõn√≠ Demo Postu - R√°j mazl√≠ƒçk≈Ø</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            max-width: 800px;
            margin: 0 auto;
            padding: 20px;
            background: #f5f5f5;
        }
        .container {
            background: white;
            padding: 20px;
            border-radius: 8px;
            box-shadow: 0 2px 10px rgba(0,0,0,0.1);
        }
        .warning {
            background: #fff3cd;
            color: #856404;
            border: 1px solid #ffeaa7;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .danger {
            background: #f8d7da;
            color: #721c24;
            border: 1px solid #f5c6cb;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        .success {
            background: #d4edda;
            color: #155724;
            border: 1px solid #c3e6cb;
            padding: 15px;
            border-radius: 4px;
            margin: 20px 0;
        }
        button {
            background: #dc3545;
            color: white;
            border: none;
            padding: 15px 30px;
            border-radius: 4px;
            cursor: pointer;
            margin: 10px;
            font-size: 16px;
            font-weight: bold;
        }
        button:hover { background: #c82333; }
        button:disabled { 
            background: #6c757d; 
            cursor: not-allowed; 
        }
        .safe-button {
            background: #28a745;
        }
        .safe-button:hover { background: #218838; }
        .log {
            background: #f8f9fa;
            border: 1px solid #dee2e6;
            border-radius: 4px;
            padding: 15px;
            margin: 20px 0;
            max-height: 400px;
            overflow-y: auto;
            font-family: monospace;
            font-size: 12px;
        }
        .status {
            padding: 15px;
            margin: 15px 0;
            border-radius: 4px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>üóëÔ∏è Odstranƒõn√≠ Demo Postu</h1>
        <p>Tento n√°stroj v√°m umo≈æn√≠ definitivnƒõ odstranit demo post "V√≠tejte v na≈°em nov√©m blogu!" a vypnout jeho automatick√© p≈ôid√°v√°n√≠.</p>
        
        <div class="warning">
            <strong>‚ö†Ô∏è Upozornƒõn√≠:</strong> Tato akce je nevratn√°! Demo post bude trvale odstranƒõn a u≈æ se nebude automaticky p≈ôid√°vat.
        </div>
        
        <div id="status"></div>
        
        <div>
            <button onclick="checkDemoPostStatus()" class="safe-button">Zkontrolovat stav demo postu</button>
            <button onclick="removeDemoPost()" class="safe-button">Odstranit demo post</button>
            <button onclick="permanentlyRemoveDemoPost()">üóëÔ∏è DEFINITIVNƒö ODSTRANIT</button>
            <button onclick="clearLog()">Vymazat log</button>
        </div>
        
        <div class="log" id="log"></div>
    </div>

    <!-- Firebase SDK -->
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-app-compat.js"></script>
    <script src="https://www.gstatic.com/firebasejs/10.7.1/firebase-firestore-compat.js"></script>
    <script src="firebase-config.js"></script>
    <script src="demo-post.js"></script>
    
    <script>
        let logElement;
        let statusElement;
        
        function log(message, type = 'info') {
            if (!logElement) logElement = document.getElementById('log');
            
            const timestamp = new Date().toLocaleTimeString();
            const logEntry = document.createElement('div');
            logEntry.innerHTML = `<span style="color: #666;">[${timestamp}]</span> ${message}`;
            
            if (type === 'error') logEntry.style.color = '#dc3545';
            else if (type === 'success') logEntry.style.color = '#28a745';
            else if (type === 'warning') logEntry.style.color = '#ffc107';
            
            logElement.appendChild(logEntry);
            logElement.scrollTop = logElement.scrollHeight;
            
            console.log(`[${timestamp}] ${message}`);
        }
        
        function updateStatus(message, type = 'info') {
            if (!statusElement) statusElement = document.getElementById('status');
            statusElement.innerHTML = `<div class="status ${type}">${message}</div>`;
        }
        
        function clearLog() {
            if (logElement) logElement.innerHTML = '';
        }
        
        async function checkDemoPostStatus() {
            log('üîç Kontroluji stav demo postu...', 'info');
            updateStatus('Kontroluji stav demo postu...', 'info');
            
            try {
                if (!firebase || !firebase.firestore) {
                    throw new Error('Firebase nen√≠ dostupn√Ω');
                }
                
                const db = firebase.firestore();
                
                // Kontrola demo postu
                const demoDoc = await db.collection('posts').doc('demo-post-1').get();
                
                // Kontrola statusu
                const statusDoc = await db.collection('system').doc('demo-post-status').get();
                
                if (demoDoc.exists) {
                    const data = demoDoc.data();
                    log(`üìÑ Demo post existuje:`, 'warning');
                    log(`   ID: ${demoDoc.id}`, 'info');
                    log(`   N√°zev: ${data.title}`, 'info');
                    log(`   Vytvo≈ôen: ${data.timestamp}`, 'info');
                } else {
                    log('‚úÖ Demo post neexistuje', 'success');
                }
                
                if (statusDoc.exists) {
                    const statusData = statusDoc.data();
                    if (statusData.disabled) {
                        log(`üîí Demo post je trvale vypnut√Ω od: ${statusData.disabledAt.toDate().toLocaleString('cs-CZ')}`, 'success');
                        log(`   D≈Øvod: ${statusData.reason}`, 'info');
                    } else {
                        log('‚ö†Ô∏è Demo post nen√≠ vypnut√Ω', 'warning');
                    }
                } else {
                    log('‚ÑπÔ∏è Demo post status neexistuje', 'info');
                }
                
                updateStatus('Kontrola dokonƒçena', 'info');
                
            } catch (error) {
                log(`‚ùå Chyba p≈ôi kontrole: ${error.message}`, 'error');
                updateStatus(`‚ùå Chyba: ${error.message}`, 'error');
            }
        }
        
        async function removeDemoPost() {
            log('üóëÔ∏è Odstra≈àuji demo post...', 'warning');
            updateStatus('Odstra≈àuji demo post...', 'warning');
            
            try {
                if (!firebase || !firebase.firestore) {
                    throw new Error('Firebase nen√≠ dostupn√Ω');
                }
                
                const db = firebase.firestore();
                
                // Odstranƒõn√≠ demo postu
                await db.collection('posts').doc('demo-post-1').delete();
                
                log('‚úÖ Demo post byl odstranƒõn!', 'success');
                updateStatus('‚úÖ Demo post byl odstranƒõn!', 'success');
                
                // Kontrola, zda byl skuteƒçnƒõ odstranƒõn
                const demoDoc = await db.collection('posts').doc('demo-post-1').get();
                if (!demoDoc.exists) {
                    log('‚úÖ Ovƒõ≈ôen√≠: Demo post skuteƒçnƒõ neexistuje', 'success');
                } else {
                    log('‚ö†Ô∏è Ovƒõ≈ôen√≠: Demo post st√°le existuje', 'warning');
                }
                
            } catch (error) {
                log(`‚ùå Chyba p≈ôi odstra≈àov√°n√≠: ${error.message}`, 'error');
                updateStatus(`‚ùå Chyba: ${error.message}`, 'error');
            }
        }
        
        async function permanentlyRemoveDemoPost() {
            log('üö® DEFINITIVNƒö ODSTRAN≈ÆJI DEMO POST...', 'error');
            updateStatus('üö® DEFINITIVNƒö ODSTRAN≈ÆJI DEMO POST...', 'error');
            
            try {
                if (!firebase || !firebase.firestore) {
                    throw new Error('Firebase nen√≠ dostupn√Ω');
                }
                
                const db = firebase.firestore();
                
                // Odstranƒõn√≠ demo postu
                await db.collection('posts').doc('demo-post-1').delete();
                log('‚úÖ Demo post byl odstranƒõn', 'success');
                
                // P≈ôid√°n√≠ flagu, ≈æe demo post je trvale vypnut√Ω
                await db.collection('system').doc('demo-post-status').set({
                    disabled: true,
                    disabledAt: new Date(),
                    reason: 'Manu√°lnƒõ vypnuto u≈æivatelem p≈ôes n√°stroj',
                    disabledBy: 'remove-demo-post.html'
                });
                
                log('üîí Demo post je nyn√≠ trvale vypnut√Ω', 'success');
                log('‚úÖ Status ulo≈æen v kolekci system', 'success');
                
                updateStatus('‚úÖ Demo post byl definitivnƒõ odstranƒõn a vypnut!', 'success');
                
                // Kontrola
                const statusDoc = await db.collection('system').doc('demo-post-status').get();
                if (statusDoc.exists && statusDoc.data().disabled) {
                    log('‚úÖ Ovƒõ≈ôen√≠: Demo post je trvale vypnut√Ω', 'success');
                }
                
            } catch (error) {
                log(`‚ùå Chyba p≈ôi definitivn√≠m odstranƒõn√≠: ${error.message}`, 'error');
                updateStatus(`‚ùå Chyba: ${error.message}`, 'error');
            }
        }
        
        // Automatick√° kontrola p≈ôi naƒçten√≠
        window.addEventListener('load', () => {
            log('üöÄ N√°stroj pro odstranƒõn√≠ demo postu naƒçten', 'info');
            log('üìã Pou≈æijte tlaƒç√≠tka pro kontrolu a odstranƒõn√≠ demo postu', 'info');
        });
    </script>
</body>
</html>
